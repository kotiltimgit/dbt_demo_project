version: 2

sources:
  - name: MATILLION
    database: DBT_DB_DEV
    schema: BRONZE
    tables:
      - name: MATILLION_SCHEDULES
        external:
          # For configuring below properties, refer this YAML: models/stages.yml
          load_config:
            stage: DM_DB.DATA_OBSERVABILITY.DATA_OBSERVABILITY_STAGE
            location_path: MATILLION_METADATA/CSV/Schedule API Endpoints.csv
            file_format: DM_DB.DATA_OBSERVABILITY.DATA_OBS_CSV_FORMAT
            copy_options:
              on_error: CONTINUE
              match_by_column_name: CASE_INSENSITIVE        
        columns:
          - name: NAME
            tests:
              - unique
              - not_null
          - name: JOBNAME
            tests:
              - not_null
          - name: HOUR
            tests:
              - not_null
          - name: MINUTE
            tests:
              - not_null
          - name: IGNOREMISFIRES
            tests:
              - accepted_values:
                  values: ['TRUE', 'FALSE']
  - name: DBT
    database: DBT_DB_DEV
    schema: BRONZE
    tables:
      - name: DBT_LISTRUNS
      - name: DBT_LISTJOBS